import{_ as e,c as s,o as a,ag as l}from"./chunks/framework.BDwTZuFy.js";const u=JSON.parse('{"title":"Lobbies & Limbo (Simple Guide)","description":"","frontmatter":{"title":"Lobbies & Limbo (Simple Guide)","sidebar":true},"headers":[],"relativePath":"VelocityPteroPower/0-9-5/lobbies-and-limbo.md","filePath":"VelocityPteroPower/0-9-5/lobbies-and-limbo.md"}'),t={name:"VelocityPteroPower/0-9-5/lobbies-and-limbo.md"};function n(o,i,r,h,p,d){return a(),s("div",null,i[0]||(i[0]=[l(`<h1 id="multi‚Äêlobby-and-limbo-‚Äì-simple-setup-üß≠" tabindex="-1">Multi‚ÄëLobby and Limbo ‚Äì Simple Setup üß≠ <a class="header-anchor" href="#multi‚Äêlobby-and-limbo-‚Äì-simple-setup-üß≠" aria-label="Permalink to &quot;Multi‚ÄëLobby and Limbo ‚Äì Simple Setup üß≠&quot;">‚Äã</a></h1><p>This page explains the new multi‚Äëlobby and multi‚Äëlimbo support in a simple, practical way. If you want the full list of options, see the lobbyBalancer section in the Configuration Guide.</p><h2 id="what-is-it" tabindex="-1">What is it? <a class="header-anchor" href="#what-is-it" aria-label="Permalink to &quot;What is it?&quot;">‚Äã</a></h2><ul><li>Lobbies are the places where players wait or gather (like hub or lobby).</li><li>Limbo is a light ‚Äúwaiting room‚Äù while a target server starts.</li><li>You can now list several lobbies and several limbos.</li><li>The plugin can choose the best one automatically and even start more lobbies when needed.</li></ul><h2 id="quick-start-recommended" tabindex="-1">Quick Start (recommended) <a class="header-anchor" href="#quick-start-recommended" aria-label="Permalink to &quot;Quick Start (recommended)&quot;">‚Äã</a></h2><ol><li>Pick the Velocity names of your lobby servers (for example lobby and hub).</li><li>Open plugins/VelocityPteroPower/config.yml.</li><li>Find the lobbyBalancer section and set something like:</li></ol><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">lobbyBalancer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  lobbies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lobby</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">hub</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  limbos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">limbo</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ROUND_ROBIN&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  minOnline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  autoScaleEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div><ol start="4"><li>If you want the plugin to be able to start a lobby when needed, make sure each lobby is also listed under the top‚Äëlevel servers: section with a valid id from your panel.</li><li>Restart or /ptero reload.</li></ol><div class="tip custom-block"><p class="custom-block-title">Keep it simple</p><p>Start with just strategy: &quot;ROUND_ROBIN&quot; and minOnline: 1. You can always tune later.</p></div><h2 id="how-the-choice-is-made" tabindex="-1">How the choice is made <a class="header-anchor" href="#how-the-choice-is-made" aria-label="Permalink to &quot;How the choice is made&quot;">‚Äã</a></h2><ul><li>The plugin prefers a lobby (from lobbies) when possible.</li><li>If no lobby is usable, it will try a limbo (from limbos).</li><li>If no limbo is usable, players may be disconnected or kept where they are until the target starts.</li></ul><h3 id="strategies" tabindex="-1">Strategies <a class="header-anchor" href="#strategies" aria-label="Permalink to &quot;Strategies&quot;">‚Äã</a></h3><ul><li>ROUND_ROBIN: cycles through your options one by one (easy and fair).</li><li>LEAST_PLAYERS: picks the one with the fewest players.</li><li>LEAST_CPU: picks the one with the lowest CPU use (needs panel resources). Use this if you want smarter picks.</li></ul><h2 id="while-your-target-server-is-starting" tabindex="-1">While your target server is starting <a class="header-anchor" href="#while-your-target-server-is-starting" aria-label="Permalink to &quot;While your target server is starting&quot;">‚Äã</a></h2><ul><li>If you try to join a server that is currently starting, and you are already on a limbo, you will remain there.</li><li>The player who initiated the server start gets a clearer message that they started the server and should wait; others are told the server is already starting.</li><li>You are automatically queued: VPP will move you to the target server as soon as it is online and past the configured join delay.</li></ul><h2 id="auto‚Äêstart-optional" tabindex="-1">Auto‚Äëstart (optional) <a class="header-anchor" href="#auto‚Äêstart-optional" aria-label="Permalink to &quot;Auto‚Äëstart (optional)&quot;">‚Äã</a></h2><p>If autoScaleEnabled: true and lobbies are defined under servers: with IDs, the plugin can start extra lobbies when:</p><ul><li>You set a minimum to keep online (minOnline), or</li><li>Current lobbies begin to fill up (playersPerServer) ‚Äî by default VPP starts a new lobby a bit early (around 80% of total lobby capacity) so players don‚Äôt hit a bottleneck. You can change this with preStartThresholdPercent.</li><li>With LEAST_CPU, a lobby‚Äôs CPU goes above cpuScaleUpThreshold.</li></ul><p>If a lobby start doesn‚Äôt succeed quickly, VPP will try a different lobby automatically (and will wait a short cooldown before retrying the failed one). You can adjust this with startFailureFallbackSeconds and startFailureCooldownSeconds.</p><div class="info custom-block"><p class="custom-block-title">Managed vs. unmanaged lobbies</p><ul><li>Managed = listed under servers: with the correct panel id ‚Üí VPP can start/stop it.</li><li>Unmanaged = only in Velocity but not in servers: ‚Üí VPP can use it if it‚Äôs already online, but can‚Äôt start it.</li></ul></div><h2 id="example-layouts" tabindex="-1">Example layouts <a class="header-anchor" href="#example-layouts" aria-label="Permalink to &quot;Example layouts&quot;">‚Äã</a></h2><details class="details custom-block"><summary>Two lobbies, one limbo (simple)</summary><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">lobbyBalancer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  lobbies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lobby</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">hub</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  limbos</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">limbo</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ROUND_ROBIN&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  minOnline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span></code></pre></div></details><details class="details custom-block"><summary>Many lobbies with scaling</summary><div class="language-yaml vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">lobbyBalancer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  lobbies</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lobby-1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lobby-2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    - </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">lobby-3</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  lobbiesToUse</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 0 = consider all listed</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  strategy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;LEAST_PLAYERS&quot;</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  playersPerServer</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  minOnline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  maxOnline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 0 = no hard cap</span></span>
<span class="line"><span style="--shiki-light:#22863A;--shiki-dark:#85E89D;">  autoScaleEnabled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span></code></pre></div></details><h2 id="common-questions" tabindex="-1">Common questions <a class="header-anchor" href="#common-questions" aria-label="Permalink to &quot;Common questions&quot;">‚Äã</a></h2><details><summary><b>Do I need to add my lobbies under servers: too?</b></summary> Add them under servers: if you want VPP to auto‚Äëstart or stop them. If you only add them to lobbies: and not servers:, VPP can still use them when they‚Äôre already online. </details><details><summary><b>What should I choose for strategy?</b></summary> Start with ROUND_ROBIN. If you notice uneven player counts, try LEAST_PLAYERS. If you care about CPU usage and have the panel resource endpoint available, try LEAST_CPU. </details><details><summary><b>What happens if all lobbies are down?</b></summary> VPP will try your configured limbos list. If none is usable, players may be disconnected or kept where they are until the target starts. </details><details><summary><b>How many lobbies should I keep online?</b></summary> For most setups, minOnline: 1 is enough. Increase if your network is busy and you want instant joins. </details><details><summary><b>Do lobbies/limbos count towards maxOnlineServers?</b></summary> By default, they do not. You can change this in config.yml: <ul><li><code>countLobbiesInMaxOnline</code> ‚Äî include lobbies in the cap when true</li><li><code>countLimbosInMaxOnline</code> ‚Äî include limbos when true</li></ul></details><h2 id="helpful-tips" tabindex="-1">Helpful tips <a class="header-anchor" href="#helpful-tips" aria-label="Permalink to &quot;Helpful tips&quot;">‚Äã</a></h2><ul><li>Keep your lobby servers lightweight for fast start times.</li><li>Set alwaysOnline: [limbo] if you want to ensure a limbo is always ready.</li><li>Use loggerLevel: 10 temporarily to see detailed balancer logs while testing.</li></ul><hr><h2 id="limbo-setup-checklist-‚úÖ" tabindex="-1">Limbo setup checklist ‚úÖ <a class="header-anchor" href="#limbo-setup-checklist-‚úÖ" aria-label="Permalink to &quot;Limbo setup checklist ‚úÖ&quot;">‚Äã</a></h2><p>Use this quick checklist to verify your configuration matches the current Limbo functionality:</p><ol><li>In config.yml: <ul><li>lobbyBalancer.limbos: [&quot;limbo&quot;]</li><li>lobbyBalancer.sendToLimboOnStart: true</li><li>(optional) lobbyBalancer.forcedHostOfflineBehavior: &quot;LOBBY_OR_LIMBO&quot;</li><li>(optional) alwaysOnline: [&quot;limbo&quot;]</li><li>(optional) moveHistory.enabled: true</li></ul></li><li>Restart the proxy or run /ptero reload.</li><li>Try connecting to a managed server that‚Äôs offline or starting: <ul><li>You should be redirected to the configured limbo and receive a message.</li><li>You will later be auto-connected when the server is ready (after its join delay).</li></ul></li><li>Runtime checks: <ul><li>/ptero info <code>&lt;server&gt;</code> now includes &quot;Started by: <code>&lt;player&gt;</code>&quot; when VPP initiated a start due to a player.</li><li>/ptero history [player] shows a pretty in-memory move history when enabled.</li></ul></li></ol><p>If your network uses forced hosts, you may prefer forcedHostOfflineBehavior: &quot;LOBBY_OR_LIMBO&quot; to keep players online while targets start.</p><hr><h2 id="limbo-records-what-vpp-tracks-üóÇÔ∏è" tabindex="-1">Limbo records: what VPP tracks üóÇÔ∏è <a class="header-anchor" href="#limbo-records-what-vpp-tracks-üóÇÔ∏è" aria-label="Permalink to &quot;Limbo records: what VPP tracks üóÇÔ∏è&quot;">‚Äã</a></h2><p>VPP maintains an in-memory record of every player currently in a limbo and why they are there. This helps diagnose edge cases where a player might remain in limbo unexpectedly.</p><ul><li><p>Data model (PlayerLimboRecord):</p><ul><li>playerId (UUID)</li><li>playerName (string)</li><li>limboServer (string)</li><li>reason (enum LimboReason): SERVER_START_WAIT, SELF_MOVE, OTHER</li><li>context (string, optional): when reason = SERVER_START_WAIT, this is the name of the server the player is waiting for</li><li>timestamp (epoch millis)</li></ul></li><li><p>When records are created:</p><ul><li>When VPP redirects a player to a limbo because their requested server is starting (reason=SERVER_START_WAIT, context=<code>&lt;target&gt;</code>).</li><li>When a player manually joins a limbo server with no prior record (reason=SELF_MOVE).</li></ul></li><li><p>When records are cleared:</p><ul><li>When the player leaves a limbo for another server.</li><li>When the player disconnects.</li><li>During periodic sweeps, if the player is no longer on a configured limbo server.</li></ul></li><li><p>Persistence: in-memory only; records do not survive a proxy restart.</p></li><li><p>Programmatic access (for developers):</p><ul><li>plugin.getLimboTrackerService().get(playerUuid) ‚Üí Optional<code>&lt;PlayerLimboRecord&gt;</code></li><li>.all() ‚Üí list of current records</li><li>.sweepNow() ‚Üí run the cleanup sweep immediately</li></ul></li></ul><p>Tip: Combine limbo records with move history (optional) for a complete picture during live operations.</p>`,41)]))}const k=e(t,[["render",n]]);export{u as __pageData,k as default};
